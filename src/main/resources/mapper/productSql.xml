<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.flab.daitso.mapper.ProductMapper">

    <select id="getProducts" parameterType="int" resultType="com.flab.daitso.dto.product.ProductDto">
        <![CDATA[
			select
			    categoryId,
			    name,
			    price,
			    content,
			    date_format(createdAt, '%Y.%m.%d %H:%i:%s') as createdAt,
			    date_format(updatedAt, '%Y.%m.%d %H:%i:%s') as updatedAt,
			    quantity
			from
			    product
			where
			    deleted = 'N' and
			    categoryId = #{id}
		]]>
    </select>

    <select id="getProduct" parameterType="String" resultType="com.flab.daitso.dto.product.ProductDto">
        <![CDATA[
			select
			    categoryId,
			    name,
			    price,
			    content,
			    date_format(createdAt, '%Y.%m.%d %H:%i:%s') as createdAt,
			    date_format(updatedAt, '%Y.%m.%d %H:%i:%s') as updatedAt,
			    quantity
			from
			    product
			where
			    deleted = 'N' and
			    name= #{productName}
		]]>
    </select>

    <update id="increaseQuantity" parameterType="String">
        <![CDATA[
			update product set
			    quantity = quantity+1,
			    updatedAt = NOW()
			where
			    name = #{productName}
		]]>
    </update>

    <insert id="registerProduct" parameterType="com.flab.daitso.dto.product.ProductDto">
        <![CDATA[
			insert into product
			(
			categoryId,
			name,
			price,
			content,
			createdAt
			)
			values
			(
			#{categoryId},
			#{name},
			#{price},
			#{content},
			NOW()
			)
		]]>
    </insert>

    <update id="deleteProduct" parameterType="String">
        <![CDATA[
            update product set
            deleted = 'Y',
            updatedAt = NOW()
            where
                name = #{productName}
		]]>
    </update>




</mapper>